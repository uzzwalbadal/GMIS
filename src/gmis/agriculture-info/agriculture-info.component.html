<div class="row clearfix" [@routerTransition]>
  <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
    <mat-card>
      <mat-tab-group dynamicHeight>
        <mat-tab label="{{projectName}} -> Agriculture Information ">
          <!-- <div class="header">
            <h2 ><b>{{projectName}} -> Agriculture Information</b></h2>
            <ul class="header-dropdown m-r--5">
              <li>
                <button
                  mat-icon-button
                  [matMenuTriggerFor]="headerMenu"
                  class="header-dropdown-mat-icon-button"
                >
                  <mat-icon>more_vert</mat-icon>
                </button>
                <mat-menu #headerMenu="matMenu">
                  <button mat-menu-item (click)="refresh()">
                    <mat-icon>refresh</mat-icon>
                    <span>Refresh</span>
                  </button>
                </mat-menu>
              </li>
            </ul>
          </div> -->
          <div class="body table">
            <form autocomplete="off" #createAgricultureDetailForm="ngForm" (ngSubmit)="onSubmitAgricultreDetail()">
              <mat-card>
                <div class="body  " style="padding: 1em;">
                  <h2>Cropping Pattern Before Project</h2>

                  <div *ngIf="ShowUpdateBtn || ShowSaveBtn">
                    <button class="btn btn-primary" type="button" (click)="addExistingCropPatternData()">Add</button>
                  </div>

                  <div id="tes" class="table-responsive">
                    <table class="table table-responsive table-hover table-striped" [busy]="isTableLoading">
                      <thead>
                        <tr>
                          <th>S.N</th>
                          <th>Crop Name</th>
                          <th>Crop Area</th>
                          <th>Average Crop Yield</th>
                          <!-- <th>Planting Date</th>
                        <th>Harvesting Date</th>
                        <th>Seed Input</th>
                        <th>Organic Manure Input</th>
                        <th>DAP Input</th>
                        <th>Potash Input</th>
                        <th>Urea Input</th>
                        <th>Human Labor Input</th>
                        <th>Animal Labor Input</th>
                        <th>Machine Input</th>
                        <th>Seed Price</th>
                        <th>Organic Manure Price</th>
                        <th>DAP Price</th>
                        <th>Potash Price</th>
                        <th>Urea Price</th>
                        <th>Human Labor Price</th>
                        <th>Animal Labor Price</th>
                        <th>Machine Price</th> -->
                          <th>Actions</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let crops of ExistingCrop_AgricultreInfos; let i =index">
                          <td>{{ i + 1 }}</td>
                          <td>{{ crops.cropIdName }}</td>
                          <td>{{ crops.cropArea }}</td>
                          <td>{{ crops.averageCropYield }}</td>
                          <!-- <td>{{ crops.plantingMonth }}, {{ crops.plantingWeek }}</td>
                        <td>{{ crops.harvestingMonth }}, {{ crops.harvestingWeek }}</td>
                        <td>{{ crops.seedInput }}</td>
                        <td>{{ crops.organicManureInput }}</td>
                        <td>{{ crops.dapInput }}</td>
                        <td>{{ crops.potashInput }}</td>
                        <td>{{ crops.ureaInput }}</td>
                        <td>{{ crops.humanLaborInput }}</td>
                        <td>{{ crops.animalLaborInput }}</td>
                        <td>{{ crops.machineLaborInput }}</td>
                        <td>{{ crops.seedPrice }}</td>
                        <td>{{ crops.organicManurePrice }}</td>
                        <td>{{ crops.dapPrice }}</td>
                        <td>{{ crops.potashPrice }}</td>
                        <td>{{ crops.ureaPrice }}</td>
                        <td>{{ crops.humanLaborPrice }}</td>
                        <td>{{ crops.animalLaborPrice }}</td>
                        <td>{{ crops.machineLaborPrice }}</td> -->

                          <td> <button mat-menu-item type="button" (click)="editExistingCropPattern(crops)">
                              <!-- <mat-icon>edit</mat-icon> -->
                              <span>View</span>
                            </button>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <button mat-stroked-button color="warn" (click)="exportExistingAsXLSX()">Export Data</button>
                </div>
                <br>
                <div class="body" style="padding: 1em;">
                  <div class="row">
                    <div class="col-md-6">
                      <mat-form-field appearance="outline">
                        <mat-label>Net Command Area</mat-label>
                        <input placeholder="Net Command Area" matInput type="number" min="0" required
                          name="existingTotalCultivatedArea" (change)="onExistingCultivatedAreaChange($event)"
                          [(ngModel)]="Dto_AgricultureDetail.existingTotalCultivatedArea">
                        <mat-hint align="end">Ha</mat-hint>
                      </mat-form-field>
                    </div>
                    <div class="col-md-6">
                      <!-- <label>Total Crop Area</label> {{ ExistingTotalCropArea }} -->
                      <label>Crop Intensity</label>
                      {{ Dto_AgricultureDetail.existingCropIntensity }} %
                    </div>
                  </div>
                </div>
              </mat-card>
              <br>
              <mat-card>
                <div class="body  " style="padding: 1em;">
                  <h2>Cropping Pattern After Project</h2>
                  <div *ngIf="ShowUpdateBtn || ShowSaveBtn">
                    <button class="btn btn-primary" type="button" (click)="addNewCropPatternData()">Add</button>
                  </div>
                  <div id="tes" class="table-responsive">

                    <table class="table table-responsive table-hover table-striped" [busy]="isTableLoading">
                      <thead>
                        <tr>
                          <th>S.N</th>
                          <th>Crop Name</th>
                          <th>Crop Area</th>
                          <th>Average Crop Yield</th>
                          <!-- <th>Planting Date</th>
                        <th>Harvesting Date</th>
                        <th>Seed Input</th>
                        <th>Organic Manure Input</th>
                        <th>DAP Input</th>
                        <th>Potash Input</th>
                        <th>Urea Input</th>
                        <th>Human Labor Input</th>
                        <th>Animal Labor Input</th>
                        <th>Machine Input</th>
                        <th>Seed Price</th>
                        <th>Organic Manure Price</th>
                        <th>DAP Price</th>
                        <th>Potash Price</th>
                        <th>Urea Price</th>
                        <th>Human Labor Price</th>
                        <th>Animal Labor Price</th>
                        <th>Machine Price</th> -->
                          <th>Actions</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let crops of NewCrop_AgricultreInfos;let i = index">
                          <!-- <td>{{ crops.totalCultivatedArea }}</td> -->
                          <td>{{ i + 1 }}</td>
                          <td>{{ crops.cropIdName }}</td>
                          <td>{{ crops.cropArea }}</td>
                          <td>{{ crops.averageCropYield }}</td>
                          <!-- <td>{{ crops.plantingMonth }}, {{ crops.plantingWeek }}</td>
                        <td>{{ crops.harvestingMonth }}, {{ crops.harvestingWeek }}</td>
                        <td>{{ crops.seedInput }}</td>
                        <td>{{ crops.organicManureInput }}</td>
                        <td>{{ crops.dapInput }}</td>
                        <td>{{ crops.potashInput }}</td>
                        <td>{{ crops.ureaInput }}</td>
                        <td>{{ crops.humanLaborInput }}</td>
                        <td>{{ crops.animalLaborInput }}</td>
                        <td>{{ crops.machineLaborInput }}</td>
                        <td>{{ crops.seedPrice }}</td>
                        <td>{{ crops.organicManurePrice }}</td>
                        <td>{{ crops.dapPrice }}</td>
                        <td>{{ crops.potashPrice }}</td>
                        <td>{{ crops.ureaPrice }}</td>
                        <td>{{ crops.humanLaborPrice }}</td>
                        <td>{{ crops.animalLaborPrice }}</td>
                        <td>{{ crops.machineLaborPrice }}</td> -->
                          <td> <button type="button" mat-menu-item (click)="editNewCropPattern(crops)">
                              <!-- <mat-icon>edit</mat-icon> -->
                              <span>View</span>
                            </button>

                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <button mat-stroked-button color="warn" (click)="exportProposedAsXLSX()">Export Data</button>
                </div>



                <div class="row">
                  <div class="col-md-6">
                    <mat-form-field appearance="outline">
                      <mat-label>Net Command Area</mat-label>
                      <input placeholder="Net Command Area" (change)="onProposedCultivatedAreaChange($event)" matInput
                        type="number" min="0" required id="proposedTotalCultivatedArea"
                        name="proposedTotalCultivatedArea"
                        [(ngModel)]="Dto_AgricultureDetail.proposedTotalCultivatedArea">
                      <mat-hint align="end">Ha</mat-hint>
                    </mat-form-field>
                  </div>
                  <div class="col-md-6">
                    <!-- <label>Total Crop Area</label> {{ NewTotalCropArea }}                 -->
                    <label>Crop Intensity</label>
                    {{ Dto_AgricultureDetail.proposedCropIntensity }}%
                  </div>
                </div>
              </mat-card>
              <br>
              <div class="body" style="padding: 1em;" id="DataDiv">
                <div class="row">
                  <div class="col-md-6">
                    <mat-form-field appearance="outline">
                      <mat-label>Nearest Agriculture Extension Office</mat-label>
                      <input placeholder="Nearest Agriculture Extension Office" matInput type="text" required
                        [(ngModel)]="Dto_AgricultureDetail.nearestAgricultureOffice" name="nearestAgricultureOffice">
                    </mat-form-field>
                  </div>
                  <div class="col-md-6">
                    <mat-form-field appearance="outline">
                      <mat-label>Distance</mat-label>
                      <input placeholder="Distance" matInput type="number" required name="agricultureOfficeDistance"
                        [(ngModel)]="Dto_AgricultureDetail.agricultureOfficeDistance" min="0">
                      <mat-hint align="end">km</mat-hint>
                    </mat-form-field>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6">
                    <mat-form-field appearance="outline">
                      <mat-label>Nearest Agrovet Centre</mat-label>
                      <input placeholder="Nearest Agrovet Centre" matInput type="text" required
                        name="nearestAgroVetOffice" [(ngModel)]="Dto_AgricultureDetail.nearestAgroVetOffice">
                      <!-- <mat-hint align="end">Kg/Ha</mat-hint> -->
                    </mat-form-field>
                  </div>
                  <div class="col-md-6">
                    <mat-form-field appearance="outline">
                      <mat-label>Distance</mat-label>
                      <input placeholder="Distance" matInput type="number" required name="agroVetOfficeDistance"
                        [(ngModel)]="Dto_AgricultureDetail.agroVetOfficeDistance" min="0">
                      <mat-hint align="end">km</mat-hint>
                    </mat-form-field>
                  </div>
                </div>
              </div>



              <div style="margin-left: 1em; padding-bottom: 1em"
                *ngIf="ExistingCrop_AgricultreInfos.length > 0 && NewCrop_AgricultreInfos.length > 0; else NoCroppingPatternAdded">
                <div *ngIf="Dto_AgricultureDetail.id > 0 ; else SaveNewData">
                  <div *ngIf="ShowUpdateBtn">
                    <button mat-flat-button type="submit" flex="15" color="primary"
                      [disabled]="!createAgricultureDetailForm.form.valid || saving || Dto_AgricultureDetail.proposedCropIntensity < 0 || Dto_AgricultureDetail.existingCropIntensity < 0 ">
                      Update
                    </button>
                  </div>
                </div>
                <ng-template #SaveNewData>
                  <div *ngIf="ShowSaveBtn">
                    <button mat-flat-button type="submit" flex="15" color="primary"
                      [disabled]="!createAgricultureDetailForm.form.valid || saving || Dto_AgricultureDetail.proposedCropIntensity < 0 || Dto_AgricultureDetail.existingCropIntensity < 0">
                      {{ "Save" | localize }}
                    </button>
                  </div>
                </ng-template>
              </div>
              <ng-template #NoCroppingPatternAdded>
                <div class="alert alert-info">
                  <h5>Please Add Cropping Pattern First</h5>
                </div>
              </ng-template>
            </form>
          </div>
        </mat-tab>
      </mat-tab-group>
    </mat-card>
  </div>
</div>